#
# ~/.environment
#
# vim: set filetype=bash
#
export EDITOR="nvim"
export BROWSER="qutebrowser"

# PATHS ####################################
# PATH
PATH="$PATH:$HOME/.local/bin"
PATH=$(printf %s "$PATH" | awk -vRS=: '!a[$0]++' | paste -s -d:)
export PATH

# FREEDESKTOP
export XDG_DATA_HOME=$HOME/.local/share
export XDG_CONFIG_HOME=$HOME/.config
export XDG_STATE_HOME=$HOME/.local/state
export XDG_CACHE_HOME=$HOME/.cache
export XDG_DATA_DIRS=/usr/local/share/:/usr/share/
export XDG_CONFIG_DIRS=/etc/xdg/

# PYTHONPATH
PYTHONPATH="/usr/bin/python:$PYTHONPATH"
PYTHONPATH=$(printf %s "$PYTHONPATH" | awk -vRS=: '!a[$0]++' | paste -s -d:)
export PYTHONPATH

export PYTHON_HISTORY="$XDG_STATE_HOME/python/history"
export PYTHONPYCACHEPREFIX="$XDG_CACHE_HOME/python"
export PYTHONUSERBASE="$XDG_DATA_HOME/python"

export RUSTUP_HOME="$XDG_DATA_HOME/rustup"
####################################################
CHEZMOI="$(chezmoi source-path)"
export CHEZMOI
export LOCALDATA="$HOME/.localdata"
export SCRIPTS="$HOME/.scripts"
export GIT_REPOS="$HOME/git"
export D="$HOME/Desktop"

export PASSWORD_STORE_DIR="$LOCALDATA/password-store"
# export PASSWORD_STORE_KEY="$LOCALDATA/password-store/.gpg-id"
#PASSWORD_STORE_GPG_OPTS
#####################################################

# MAKE VIM XDG COMPLIANT
mkdir -p "$XDG_CONFIG_HOME/vim"
mkdir -p "$XDG_STATE_HOME/vim"
mkdir -p "$XDG_DATA_HOME/vim"
export VIM_CONFIG_HOME="$XDG_CONFIG_HOME/vim"

# THEME
export FLEXOKI_BLACK='#100f0f'
export FLEXOKI_BASE_950='#1C1B1A'
export FLEXOKI_BASE_900='#282726'
export FLEXOKI_BASE_850='#343331'
export FLEXOKI_BASE_800='#403E3C'
export FLEXOKI_BASE_700='#575653'
export FLEXOKI_BASE_600='#6F6E69'
export FLEXOKI_BASE_500='#878580'
export FLEXOKI_BASE_300='#B7B5AC'
export FLEXOKI_BASE_200='#CECDC3'
export FLEXOKI_BASE_150='#DAD8CE'
export FLEXOKI_BASE_100='#E6E4D9'
export FLEXOKI_BASE_50='#F2F0E5'
export FLEXOKI_PAPER='#FFFCF0'
export FLEXOKI_RED='#AF3029'
export FLEXOKI_ORANGE='#BC5215'
export FLEXOKI_YELLOW='#AD8301'
export FLEXOKI_GREEN='#66800B'
export FLEXOKI_CYAN='#24837B'
export FLEXOKI_BLUE='#205EA6'
export FLEXOKI_PURPLE='#5E409D'
export FLEXOKI_MAGENTA='#A02F6F'
export FLEXOKI_RED_2='#D14D41'
export FLEXOKI_ORANGE_2='#DA702C'
export FLEXOKI_YELLOW_2='#D0A215'
export FLEXOKI_GREEN_2='#879A39'
export FLEXOKI_CYAN_2='#3AA99F'
export FLEXOKI_BLUE_2='#4385BE'
export FLEXOKI_PURPLE_2='#8B7EC8'
export FLEXOKI_MAGENTA_2='#CE5D97'

export QT_QPA_PLATFORMTHEME=qt6ct

export FZF_DEFAULT_OPTS="
--color=fg:$FLEXOKI_BASE_200,bg:$FLEXOKI_BLACK,hl:$FLEXOKI_MAGENTA
--color=fg+:$FLEXOKI_PAPER,bg+:$FLEXOKI_BASE_900,hl+:$FLEXOKI_MAGENTA
--color=border:$FLEXOKI_YELLOW,header:$FLEXOKI_BASE_200,gutter:$FLEXOKI_BLACK
--color=spinner:$FLEXOKI_GREEN,info:$FLEXOKI_GREEN,separator:$FLEXOKI_BASE_700
--color=pointer:$FLEXOKI_YELLOW,scrollbar:$FLEXOKI_GREEN,prompt:$FLEXOKI_YELLOW
--highlight-line"

export FZF_CTRL_T_OPTS="
--preview 'bat -n --color=always {}'
--bind 'ctrl-/:change-preview-window(down|hidden|)'"

export FZF_ALT_C_OPTS="
--preview 'tree -C {}'"
#gtk
#___both can be useful on old screens
#export GSK_RENDERER='gl'
#export GSK_DEBUG='gl-no-fractional'

# ZOXIDE
export _ZO_ECHO=1

# RANGER
export RANGER_LOAD_DEFAULT_RC=false

# OLLAMA
if [ "$(hostnamectl hostname)" = "karjala" ]; then
    export OLLAMA_MODELS="/mnt/SSD/ollama_models"
fi
export OLLAMA_KEEP_ALIVE="10m" #default is 5m

#TODO: Move everything related to aichat to the .env file in config (as per 0.20)
export AICHAT_CONFIG_DIR="$XDG_CONFIG_HOME/aichat" #Customize the location of the config dir. Defaults to <user_config_dir>/aichat.

export AICHAT_CONFIG_FILE="$AICHAT_CONFIG_DIR/config.yaml" #Customize the location of the config.yaml file.
export AICHAT_FUNCTIONS_DIR="$AICHAT_CONFIG_DIR/functions" #Customize the location of the functions dir.
export AICHAT_ROLES_FILE="$AICHAT_CONFIG_DIR/roles.yaml" #Customize the location of the roles.yaml file.
export AICHAT_AGENTS_FUNCTIONS_DIR="$AICHAT_CONFIG_DIR/functions/agents" #Customize the location of the functions/agents dir.
export AICHAT_AGENTS_CONFIG_DIR="$AICHAT_CONFIG_DIR/agents" #Customize the location of the agents dir.

mkdir -p "$XDG_DATA_HOME/aichat"
mkdir -p "$XDG_DATA_HOME/aichat/rags"
mkdir -p "$XDG_DATA_HOME/aichat/sessions"
export AICHAT_MESSAGES_FILE="$XDG_DATA_HOME/aichat/messages.md" #Customize the location of the messages.md file.
export AICHAT_SESSIONS_DIR="$XDG_DATA_HOME/aichat/sessions" #Customize the location of the sessions dir.
export AICHAT_RAGS_DIR="$XDG_DATA_HOME/aichat/rags" #Customize the location of the rags dir.
#end of TODO:

if [ -z "${LOADED_PASS_SECRET_ENV}" ]; then
    export LOADED_PASS_SECRET_ENV=1
    export SPOTIFY_CLIENT_SECRET="$(pass ENV/SPOTIFY_CLIENT_SECRET)"
    export ANTHROPIC_API_KEY="$(pass ENV/ANTHROPIC_API_KEY)"
    export GEMINI_API_KEY="$(pass ENV/GEMINI_API_KEY)"
    export OPENAI_API_KEY="$(pass ENV/OPENAI_API_KEY)"
    export PERPLEXITY_API_KEY="$(pass ENV/PERPLEXITY_API_KEY)"
    export MISTRAL_API_KEY="$(pass ENV/MISTRAL_API_KEY)"
    export CLAUDE_API_KEY="$(pass ENV/CLAUDE_API_KEY)"
    clear
    fastfetch
fi
